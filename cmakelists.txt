cmake_minimum_required(VERSION 3.23)
set(CMAKE_VERBOSE_MAKEFILE ON)

# Add common variables
set(FLAVO_ROOT_DIR "${CMAKE_CURRENT_SOURCE_DIR}")
set(FLAVO_SDK_DIR "${FLAVO_ROOT_DIR}/sdk")
set(FLAVO_ENGINE_SRC_DIR "${FLAVO_ROOT_DIR}/engine/source")
set(FLAVO_RENDERER_SRC_DIR "${FLAVO_ROOT_DIR}/renderer/source")
set(FLAVO_GAME_SRC_DIR "${FLAVO_ROOT_DIR}/game_engine/source")
set(FLAVO_WH_SRC_DIR "${FLAVO_ROOT_DIR}/wh/source")

# Set output paths
set(CMAKE_ARCHIVE_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/../lib)
set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/../lib)
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/..)

# Set project settings
set(CMAKE_CXX_STANDARD 23)
set(CMAKE_CXX_STANDARD_REQUIRED True)
# Enable filters in Visual Studio
set_property(GLOBAL PROPERTY USE_FOLDERS ON)

# Add sdk projects
add_subdirectory("${FLAVO_SDK_DIR}/flecs")
add_subdirectory("${FLAVO_SDK_DIR}/thread_pool")

# Add engine projects
add_subdirectory("${FLAVO_ENGINE_SRC_DIR}/core")
add_subdirectory("${FLAVO_ENGINE_SRC_DIR}/ecs")

# Add renderer projects
add_subdirectory("${FLAVO_RENDERER_SRC_DIR}/renderer")
add_subdirectory("${FLAVO_RENDERER_SRC_DIR}/renderer_dx12")

# Add game engine projects
add_subdirectory("${FLAVO_GAME_SRC_DIR}/game_core")

# Add main application project
project(Warthog)
add_executable(Warthog "${FLAVO_WH_SRC_DIR}/main.cpp")
target_include_directories(Warthog PRIVATE "${FLAVO_ENGINE_SRC_DIR}")
target_include_directories(Warthog PRIVATE "${FLAVO_RENDERER_SRC_DIR}")
target_include_directories(Warthog PRIVATE "${FLAVO_GAME_SRC_DIR}")
target_include_directories(Warthog PRIVATE "${FLAVO_WH_SRC_DIR}")
target_link_libraries(Warthog PRIVATE Core)
target_link_libraries(Warthog PRIVATE Renderer)
target_link_libraries(Warthog PRIVATE ECS)
target_link_libraries(Warthog PRIVATE GameCore)
